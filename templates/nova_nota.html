{% extends "base.html" %}
{% block content %}
<h4>Emitir Nota</h4>
<form method="post">
    <div class="mb-3">
        <label>Tipo</label>
        <select class="form-select" name="tipo">
            <option value="nao_fiscal">Recibo (não fiscal)</option>
            <option value="fiscal">Nota Fiscal (fiscal)</option>
        </select>
    </div>

    <div class="mb-3">
        <label>Cliente</label>
        <select class="form-select" name="cliente">
            <option value="">Consumidor</option>
            {% for c in clients %}
            <option value="{{ c.id }}">{{ c.nome }} {% if c.cpf_cnpj %} ({{ c.cpf_cnpj }}){% endif %}</option>
            {% endfor %}
        </select>
    </div>

    <h5>Itens</h5>
    <div id="items">
        <div class="row g-2 mb-2 item">
            <div class="col-md-6"><input name="item-0-desc" placeholder="Descrição" class="form-control"></div>
            <div class="col-md-3"><input name="item-0-price" placeholder="Preço" class="form-control" type="number"
                    step="0.01"></div>
            <div class="col-md-2"><input name="item-0-qty" placeholder="Qtde" class="form-control" type="number"
                    value="1"></div>
        </div>
    </div>
    <button type="button" class="btn btn-sm btn-secondary mb-3" onclick="addItem()">Adicionar item</button>
    <div><button class="btn btn-success">Emitir</button></div>
</form>

<script>
    let idx = 1;
    function addItem() {
        const container = document.getElementById('items');
        const div = document.createElement('div');
        div.className = 'row g-2 mb-2 item';
        div.innerHTML = `
    <div class="col-md-6"><input name="item-${idx}-desc" placeholder="Descrição" class="form-control"></div>
    <div class="col-md-3"><input name="item-${idx}-price" placeholder="Preço" class="form-control" type="number" step="0.01"></div>
    <div class="col-md-2"><input name="item-${idx}-qty" placeholder="Qtde" class="form-control" type="number" value="1"></div>
  `;
        container.appendChild(div);
        idx++;
    }
</script>
{% endblock %}